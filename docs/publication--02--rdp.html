<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Digital PCR with the RDP database</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84254038-1', 'auto');
  ga('send', 'pageview');

</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><div class="logo_frame"><span class="logo_helper"></span><img src="images/hex_sticker.png" height=50px /></div> metacoder</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="example.html">Example</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Workshop
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="workshop--00--introduction.html">Introduction</a>
    </li>
    <li>
      <a href="workshop--00--required_software.html">Required software</a>
    </li>
    <li>
      <a href="workshop--00--required_data.html">Required datasets</a>
    </li>
    <li>
      <a href="workshop--03--parsing.html">Getting data into R</a>
    </li>
    <li>
      <a href="workshop--04--manipulating.html">Manipulating taxonomic data</a>
    </li>
    <li>
      <a href="workshop--05--plotting.html">Plotting taxonomic data</a>
    </li>
    <li>
      <a href="workshop--06--quality_control.html">Data quality control</a>
    </li>
    <li>
      <a href="workshop--07--diversity_stats.html">Diversity and Ordination</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Publication
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005404">PLOS Comp Bio paper</a>
    </li>
    <li>
      <a href="publication--05--16s_human_microbiome.html">Human microbiome</a>
    </li>
    <li>
      <a href="publication--06--tara_oceans.html">TARA Oceans</a>
    </li>
    <li>
      <a href="publication--01--silva.html">Digital PCR: SILVA</a>
    </li>
    <li>
      <a href="publication--02--rdp.html">Digital PCR: RDP</a>
    </li>
    <li>
      <a href="publication--03--greengenes.html">Digital PCR: Greengenes</a>
    </li>
    <li>
      <a href="publication--04--16s_database_comparision.html">Digital PCR: Comparing databases</a>
    </li>
    <li>
      <a href="publication--08--voting.html">Voting Geography</a>
    </li>
    <li>
      <a href="publication--09--gene_expression.html">Gene Expression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendices
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="appendix--00--intro_to_r.html">Introduction to R</a>
    </li>
    <li>
      <a href="appendix--00--intro_to_rstudio.html">Introduction to RStudio</a>
    </li>
    <li>
      <a href="appendix--00--glossary.html">Glossary</a>
    </li>
    <li>
      <a href="appendix--00--presentation_page.html">Slide show</a>
    </li>
    <li>
      <a href="appendix--00--poster_page.html">Poster</a>
    </li>
    <li>
      <a href="https://github.com/grunwaldlab/metacoder">Metacoder source code</a>
    </li>
    <li>
      <a href="https://github.com/grunwaldlab/metacoder_documentation">Website source code</a>
    </li>
  </ul>
</li>
<li>
  <a href="faq.html">FAQ</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Digital PCR with the RDP database</h1>

</div>


<div id="requirements" class="section level2">
<h2>Requirements</h2>
<p><strong>NOTE:</strong> This analysis requires at least 10Gb of RAM to run. It uses large files not included in the repository and many steps can take a few minutes to run.</p>
</div>
<div id="parameters" class="section level2">
<h2>Parameters</h2>
<div id="analysis-inputoutput" class="section level3">
<h3>Analysis input/output</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>input_folder &lt;-<span class="st"> &quot;raw_input&quot;</span> <span class="co"># Where all the large input files are. Ignored by git. </span></span>
<span id="cb1-2"><a href="#cb1-2"></a>output_folder &lt;-<span class="st"> &quot;results&quot;</span> <span class="co"># Where plots will be saved</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>output_format &lt;-<span class="st"> &quot;pdf&quot;</span> <span class="co"># The file format of saved plots</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>pub_fig_folder &lt;-<span class="st"> &quot;publication&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>revision_n &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>result_path &lt;-<span class="st"> </span><span class="cf">function</span>(name) {</span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="kw">file.path</span>(output_folder, <span class="kw">paste0</span>(name, <span class="st">&quot;.&quot;</span>, output_format))</span>
<span id="cb1-8"><a href="#cb1-8"></a>}</span>
<span id="cb1-9"><a href="#cb1-9"></a>save_publication_fig &lt;-<span class="st"> </span><span class="cf">function</span>(name, figure_number) {</span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="kw">file.path</span>(<span class="kw">result_path</span>(name), <span class="kw">paste0</span>(<span class="st">&quot;revision_&quot;</span>, revision_n), <span class="kw">paste0</span>(<span class="st">&quot;figure_&quot;</span>, figure_number, <span class="st">&quot;--&quot;</span>, name, <span class="st">&quot;.&quot;</span>, output_format))</span>
<span id="cb1-11"><a href="#cb1-11"></a>}</span></code></pre></div>
</div>
<div id="analysis-parameters" class="section level3">
<h3>Analysis parameters</h3>
<p>These settings are shared between the RDP, SILVA, and Greengenes analyses, since the results of those three analyeses are combined in one plot later. This ensures that all of the graphs use the same color and size scales, instead of optimizing them for each data set, as would be done automatically otherwise.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>size_range &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.0004</span>, <span class="fl">0.015</span>) <span class="co"># The size range of nodes</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>label_size_range &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.002</span>, <span class="fl">0.05</span>) <span class="co"># The size range of labels</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>all_size_interval &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3000000</span>) <span class="co"># The range of read counts to display in the whole database plots</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>pcr_size_interval &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">25000</span>) <span class="co"># The range of read counts to display in the PCR plots</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>label_max &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co"># The maximum number of labels to show on each graph</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>max_taxonomy_depth &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># The maximum number of taxonomic ranks to show</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>min_seq_count &lt;-<span class="st"> </span><span class="ot">NULL</span> <span class="co"># The minimum number of sequeces need to show a taxon.</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>just_bacteria &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co"># If TRUE, only show bacterial taxa</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>max_mismatch &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co"># Percentage mismatch tolerated in pcr</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>pcr_success_cutoff &lt;-<span class="st"> </span><span class="fl">0.90</span> <span class="co"># Any taxon with a greater proportion of PCR sucess will be excluded from the PCR plots</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>min_seq_length &lt;-<span class="st"> </span><span class="dv">1200</span> <span class="co"># Use to encourage full length sequences</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>forward_primer =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;515F&quot;</span> =<span class="st"> &quot;GTGYCAGCMGCCGCGGTAA&quot;</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a>reverse_primer =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;806R&quot;</span> =<span class="st"> &quot;GGACTACNVGGGTWTCTAAT&quot;</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>pcr_success_color_scale =<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">plasma</span>(<span class="dv">10</span>)[<span class="dv">4</span><span class="op">:</span><span class="dv">9</span>], <span class="st">&quot;lightgrey&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="parse-database" class="section level2">
<h2>Parse database</h2>
<p>The code below parses and subsets the entire RDP non-redundant reference database <span class="citation">(Maidak et al. 2001)</span>. The input file is not included in this repository because it is 3.6GB, but you can download it from the RDP website here:</p>
<p><a href="https://rdp.cme.msu.edu/misc/resources.jsp" class="uri">https://rdp.cme.msu.edu/misc/resources.jsp</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(metacoder)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>rdp_seq &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">read.FASTA</span>(<span class="kw">file.path</span>(input_folder, <span class="st">&quot;rdp_current_Bacteria_unaligned.fa&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2"></a>rdp &lt;-<span class="st"> </span><span class="kw">extract_tax_data</span>(<span class="kw">names</span>(rdp_seq),</span>
<span id="cb4-3"><a href="#cb4-3"></a>                        <span class="dt">regex =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">tLineage(.*)&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>                        <span class="dt">key =</span> <span class="kw">c</span>(<span class="st">&quot;class&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5"></a>                        <span class="dt">class_regex =</span> <span class="st">&quot;[;=](.+?);(.+?)&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6"></a>                        <span class="dt">class_key =</span> <span class="kw">c</span>(<span class="st">&quot;taxon_name&quot;</span>, <span class="dt">rdp_rank =</span> <span class="st">&quot;taxon_rank&quot;</span>))</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># rdp_seq &lt;- unlist(lapply(as.character(rdp_seq), paste0, collapse = &quot;&quot;))</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>rdp<span class="op">$</span>data<span class="op">$</span>sequence &lt;-<span class="st"> </span><span class="kw">setNames</span>(rdp_seq, rdp<span class="op">$</span>data<span class="op">$</span>tax_data<span class="op">$</span>taxon_id)</span>
<span id="cb4-9"><a href="#cb4-9"></a>rdp<span class="op">$</span>data<span class="op">$</span>class_data &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">print</span>(rdp)</span></code></pre></div>
<pre class="r-output"><code>## &lt;Taxmap&gt;
##   2614 taxa: <span style='color: #00BB00;'>aab</span><span>. Root, </span><span style='color: #00BB00;'>aac</span><span>. Bacteria ... </span><span style='color: #00BB00;'>dwn</span><span>. Rubrobacter, </span><span style='color: #00BB00;'>dwo</span><span>. Sphaerobacter
##   2614 edges: </span><span style='color: #00BB00;'>NA</span><span>-&gt;</span><span style='color: #00BB00;'>aab</span><span>, </span><span style='color: #00BB00;'>aab</span><span>-&gt;</span><span style='color: #00BB00;'>aac</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aad</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aae</span><span> ... </span><span style='color: #00BB00;'>dkk</span><span>-&gt;</span><span style='color: #00BB00;'>dwm</span><span>, </span><span style='color: #00BB00;'>dkn</span><span>-&gt;</span><span style='color: #00BB00;'>dwn</span><span>, </span><span style='color: #00BB00;'>dkw</span><span>-&gt;</span><span style='color: #00BB00;'>dwo</span><span>
##   2 data sets:
##     </span><span style='font-weight: bold;'>tax_data</span><span>:
## </span><span style='font-style: italic;'>      # A tibble: 3,070,243 x 2</span><span>
##        </span><span style='color: #00BB00;'> taxon_id </span><span>input                                                                    
## </span><span style='font-style: italic;'>        &lt;chr&gt;    &lt;chr&gt;                                                                    </span><span>
##       1 </span><span style='color: #00BB00;'>dlq</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       2 </span><span style='color: #00BB00;'>dlq</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       3 </span><span style='color: #00BB00;'>dlq</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       # … with 3,070,240 more rows
##     </span><span style='font-weight: bold;'>sequence</span><span>:
##       3070243 DNA sequences in binary format stored in a list.
##       
##       Mean sequence length: 1042.096 
##          Shortest sequence: 400 
##           Longest sequence: 2922 
##       
##       Labels:
##       dlq
##       dlq
##       dlq
##       dlq
##       dlq
##       dlq
##       ...
##       
##       More than 10 million bases: not printing base composition.
##       (Total: 3.2 Gb)
##   0 functions:
</span></code></pre>
</div>
<div id="subset" class="section level2">
<h2>Subset</h2>
<p>Next I will subset the taxa in the dataset (depending on parameter settings). This can help make the graphs less cluttered and make it easier to compare databases.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw">is.null</span>(min_seq_count)) {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  rdp &lt;-<span class="st"> </span><span class="kw">filter_taxa</span>(rdp, n_obs <span class="op">&gt;=</span><span class="st"> </span>min_seq_count)</span>
<span id="cb5-3"><a href="#cb5-3"></a>}</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="cf">if</span> (just_bacteria) {</span>
<span id="cb5-5"><a href="#cb5-5"></a>  rdp &lt;-<span class="st"> </span><span class="kw">filter_taxa</span>(rdp, taxon_names <span class="op">==</span><span class="st"> &quot;Bacteria&quot;</span>, <span class="dt">subtaxa =</span> <span class="ot">TRUE</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>}</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw">is.null</span>(max_taxonomy_depth)) {</span>
<span id="cb5-8"><a href="#cb5-8"></a>  rdp &lt;-<span class="st"> </span><span class="kw">filter_taxa</span>(rdp, n_supertaxa <span class="op">&lt;=</span><span class="st"> </span>max_taxonomy_depth)</span>
<span id="cb5-9"><a href="#cb5-9"></a>}</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="kw">print</span>(rdp)</span></code></pre></div>
<pre class="r-output"><code>## &lt;Taxmap&gt;
##   667 taxa: <span style='color: #00BB00;'>aac</span><span>. Bacteria, </span><span style='color: #00BB00;'>aad</span><span>. "Actinobacteria" ... </span><span style='color: #00BB00;'>azs</span><span>. Nitrospinaceae
##   667 edges: </span><span style='color: #00BB00;'>NA</span><span>-&gt;</span><span style='color: #00BB00;'>aac</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aad</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aae</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aaf</span><span> ... </span><span style='color: #00BB00;'>anl</span><span>-&gt;</span><span style='color: #00BB00;'>azq</span><span>, </span><span style='color: #00BB00;'>anm</span><span>-&gt;</span><span style='color: #00BB00;'>azr</span><span>, </span><span style='color: #00BB00;'>ann</span><span>-&gt;</span><span style='color: #00BB00;'>azs</span><span>
##   2 data sets:
##     </span><span style='font-weight: bold;'>tax_data</span><span>:
## </span><span style='font-style: italic;'>      # A tibble: 3,070,243 x 2</span><span>
##        </span><span style='color: #00BB00;'> taxon_id </span><span>input                                                                    
## </span><span style='font-style: italic;'>        &lt;chr&gt;    &lt;chr&gt;                                                                    </span><span>
##       1 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       2 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       3 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       # … with 3,070,240 more rows
##     </span><span style='font-weight: bold;'>sequence</span><span>:
##       3070243 DNA sequences in binary format stored in a list.
##       
##       Mean sequence length: 1042.096 
##          Shortest sequence: 400 
##           Longest sequence: 2922 
##       
##       Labels:
##       ano
##       ano
##       ano
##       ano
##       ano
##       ano
##       ...
##       
##       More than 10 million bases: not printing base composition.
##       (Total: 3.2 Gb)
##   0 functions:
</span></code></pre>
</div>
<div id="remove-chloroplast-sequences" class="section level2">
<h2>Remove chloroplast sequences</h2>
<p>These are not bacterial and will bias the digital PCR results. Note that the <code>invert</code> option makes it so taxa are included that <em>did not</em> pass the filter. This is different than simply using <code>name != "Chloroplast", subtaxa = TRUE</code> since the effects of <code>invert</code> are applied after those of <code>subtaxa</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>rdp &lt;-<span class="st"> </span><span class="kw">filter_taxa</span>(rdp, taxon_names <span class="op">==</span><span class="st"> &quot;Cyanobacteria/Chloroplast&quot;</span>, <span class="dt">subtaxa =</span> <span class="ot">TRUE</span>, <span class="dt">invert =</span> <span class="ot">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">print</span>(rdp)</span></code></pre></div>
<pre class="r-output"><code>## &lt;Taxmap&gt;
##   629 taxa: <span style='color: #00BB00;'>aac</span><span>. Bacteria, </span><span style='color: #00BB00;'>aad</span><span>. "Actinobacteria" ... </span><span style='color: #00BB00;'>azs</span><span>. Nitrospinaceae
##   629 edges: </span><span style='color: #00BB00;'>NA</span><span>-&gt;</span><span style='color: #00BB00;'>aac</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aad</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aae</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aaf</span><span> ... </span><span style='color: #00BB00;'>amx</span><span>-&gt;</span><span style='color: #00BB00;'>ayv</span><span>, </span><span style='color: #00BB00;'>anm</span><span>-&gt;</span><span style='color: #00BB00;'>azr</span><span>, </span><span style='color: #00BB00;'>ann</span><span>-&gt;</span><span style='color: #00BB00;'>azs</span><span>
##   2 data sets:
##     </span><span style='font-weight: bold;'>tax_data</span><span>:
## </span><span style='font-style: italic;'>      # A tibble: 3,070,243 x 2</span><span>
##        </span><span style='color: #00BB00;'> taxon_id </span><span>input                                                                    
## </span><span style='font-style: italic;'>        &lt;chr&gt;    &lt;chr&gt;                                                                    </span><span>
##       1 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       2 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       3 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       # … with 3,070,240 more rows
##     </span><span style='font-weight: bold;'>sequence</span><span>:
##       3070243 DNA sequences in binary format stored in a list.
##       
##       Mean sequence length: 1042.096 
##          Shortest sequence: 400 
##           Longest sequence: 2922 
##       
##       Labels:
##       ano
##       ano
##       ano
##       ano
##       ano
##       ano
##       ...
##       
##       More than 10 million bases: not printing base composition.
##       (Total: 3.2 Gb)
##   0 functions:
</span></code></pre>
</div>
<div id="plot-whole-database" class="section level2">
<h2>Plot whole database</h2>
<p>Although graphing everything can be a bit overwhelming ( taxa), it gives an intuitive feel for the complexity of the database:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>rdp_plot_all &lt;-<span class="st"> </span><span class="kw">heat_tree</span>(rdp,</span>
<span id="cb7-2"><a href="#cb7-2"></a>                          <span class="dt">node_size =</span> n_obs,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                          <span class="dt">node_color =</span> n_obs,</span>
<span id="cb7-4"><a href="#cb7-4"></a>                          <span class="dt">node_size_range =</span> size_range <span class="op">*</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb7-5"><a href="#cb7-5"></a>                          <span class="dt">edge_size_range =</span> size_range,</span>
<span id="cb7-6"><a href="#cb7-6"></a>                          <span class="dt">node_size_interval =</span> all_size_interval,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                          <span class="dt">edge_size_interval =</span> all_size_interval,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                          <span class="dt">node_color_interval =</span> all_size_interval,</span>
<span id="cb7-9"><a href="#cb7-9"></a>                          <span class="dt">edge_color_interval =</span> all_size_interval,</span>
<span id="cb7-10"><a href="#cb7-10"></a>                          <span class="dt">node_label =</span> taxon_names,</span>
<span id="cb7-11"><a href="#cb7-11"></a>                          <span class="dt">node_label_size_range =</span> label_size_range,</span>
<span id="cb7-12"><a href="#cb7-12"></a>                          <span class="dt">node_label_max =</span> label_max,</span>
<span id="cb7-13"><a href="#cb7-13"></a>                          <span class="dt">node_color_axis_label =</span> <span class="st">&quot;Sequence count&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>                          <span class="dt">output_file =</span> <span class="kw">result_path</span>(<span class="st">&quot;rdp--all&quot;</span>))</span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="kw">print</span>(rdp_plot_all)</span></code></pre></div>
<p><img src="publication--02--rdp_files/figure-html/rdp_plot_all-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="pcr" class="section level2">
<h2>PCR</h2>
<p>Before doing the digital PCR, I will filter for only full length sequences, since shorter sequences might not have a primer binding site and the digital PCR would fail, not because of an inability of a real primer to bind to real DNA, but because of missing sequence information in the database. Ideally, this kind of filtering for full length sequences would involve something like a multiple sequences alignment so we don’t remove sequences that are actually full length, but just happen to be shorter than the cutoff of 1200 naturally. However, this method is easy and should work OK.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw">is.null</span>(min_seq_length)) {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  long_enough &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">vapply</span>(rdp<span class="op">$</span>data<span class="op">$</span>sequence, length, <span class="kw">numeric</span>(<span class="dv">1</span>)) <span class="op">&gt;=</span><span class="st"> </span>min_seq_length)</span>
<span id="cb8-3"><a href="#cb8-3"></a>  rdp &lt;-<span class="st"> </span><span class="kw">filter_obs</span>(rdp, <span class="st">&quot;sequence&quot;</span>, long_enough)</span>
<span id="cb8-4"><a href="#cb8-4"></a>  rdp &lt;-<span class="st"> </span><span class="kw">filter_obs</span>(rdp, <span class="st">&quot;tax_data&quot;</span>, long_enough, <span class="dt">drop_taxa =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a>}</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="kw">print</span>(rdp)</span></code></pre></div>
<pre class="r-output"><code>## &lt;Taxmap&gt;
##   619 taxa: <span style='color: #00BB00;'>aac</span><span>. Bacteria, </span><span style='color: #00BB00;'>aad</span><span>. "Actinobacteria" ... </span><span style='color: #00BB00;'>azs</span><span>. Nitrospinaceae
##   619 edges: </span><span style='color: #00BB00;'>NA</span><span>-&gt;</span><span style='color: #00BB00;'>aac</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aad</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aae</span><span>, </span><span style='color: #00BB00;'>aac</span><span>-&gt;</span><span style='color: #00BB00;'>aaf</span><span> ... </span><span style='color: #00BB00;'>amx</span><span>-&gt;</span><span style='color: #00BB00;'>ayv</span><span>, </span><span style='color: #00BB00;'>anm</span><span>-&gt;</span><span style='color: #00BB00;'>azr</span><span>, </span><span style='color: #00BB00;'>ann</span><span>-&gt;</span><span style='color: #00BB00;'>azs</span><span>
##   2 data sets:
##     </span><span style='font-weight: bold;'>tax_data</span><span>:
## </span><span style='font-style: italic;'>      # A tibble: 1,516,302 x 2</span><span>
##        </span><span style='color: #00BB00;'> taxon_id </span><span>input                                                                    
## </span><span style='font-style: italic;'>        &lt;chr&gt;    &lt;chr&gt;                                                                    </span><span>
##       1 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       2 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       3 </span><span style='color: #00BB00;'>ano</span><span>      "\tLineage=Root;rootrank;Bacteria;domain;\"Actinobacteria\";phylum;Actin…
##       # … with 1,516,299 more rows
##     </span><span style='font-weight: bold;'>sequence</span><span>:
##       1516302 DNA sequences in binary format stored in a list.
##       
##       Mean sequence length: 1400.489 
##          Shortest sequence: 1200 
##           Longest sequence: 2922 
##       
##       Labels:
##       ano
##       ano
##       ano
##       ano
##       ano
##       ano
##       ...
##       
##       More than 10 million bases: not printing base composition.
##       (Total: 2.12 Gb)
##   0 functions:
</span></code></pre>
<p>Next I will conduct digital PCR with a new set of universal 16S primers <span class="citation">(Walters et al. 2016)</span>, allowing for a maximum mismatch of 10%.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>rdp_pcr &lt;-<span class="st"> </span><span class="kw">primersearch</span>(rdp, sequence,</span>
<span id="cb9-2"><a href="#cb9-2"></a>                        <span class="dt">forward =</span> forward_primer,</span>
<span id="cb9-3"><a href="#cb9-3"></a>                        <span class="dt">reverse =</span> reverse_primer,</span>
<span id="cb9-4"><a href="#cb9-4"></a>                        <span class="dt">mismatch =</span> max_mismatch)</span></code></pre></div>
<p>Now the object <code>rdp_pcr</code> has all the information that <code>rdp</code> has plus the results of the digital PCR. Lets plot the whole database again, but coloring based on digital PCR success.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>rdp_plot_pcr_all &lt;-<span class="st"> </span><span class="kw">heat_tree</span>(rdp_pcr,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                              <span class="dt">node_size =</span> seq_count,</span>
<span id="cb10-3"><a href="#cb10-3"></a>                              <span class="dt">node_size_range =</span> size_range <span class="op">*</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>                              <span class="dt">edge_size_range =</span> size_range,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                              <span class="dt">node_size_interval =</span> all_size_interval,</span>
<span id="cb10-6"><a href="#cb10-6"></a>                              <span class="dt">edge_size_interval =</span> all_size_interval,</span>
<span id="cb10-7"><a href="#cb10-7"></a>                              <span class="dt">node_label =</span> taxon_names,</span>
<span id="cb10-8"><a href="#cb10-8"></a>                              <span class="dt">node_color =</span> prop_amplified,</span>
<span id="cb10-9"><a href="#cb10-9"></a>                              <span class="dt">node_color_range =</span>  pcr_success_color_scale,</span>
<span id="cb10-10"><a href="#cb10-10"></a>                              <span class="dt">node_color_trans =</span> <span class="st">&quot;linear&quot;</span>,</span>
<span id="cb10-11"><a href="#cb10-11"></a>                              <span class="dt">node_label_size_range =</span> label_size_range,</span>
<span id="cb10-12"><a href="#cb10-12"></a>                              <span class="dt">node_label_max =</span> label_max,</span>
<span id="cb10-13"><a href="#cb10-13"></a>                              <span class="dt">edge_color_interval =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb10-14"><a href="#cb10-14"></a>                              <span class="dt">node_color_interval =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb10-15"><a href="#cb10-15"></a>                              <span class="dt">node_color_axis_label =</span> <span class="st">&quot;Proportion PCR success&quot;</span>,</span>
<span id="cb10-16"><a href="#cb10-16"></a>                              <span class="dt">node_size_axis_label =</span> <span class="st">&quot;Sequence count&quot;</span>,</span>
<span id="cb10-17"><a href="#cb10-17"></a>                              <span class="dt">output_file =</span> <span class="kw">result_path</span>(<span class="st">&quot;rdp--pcr_all&quot;</span>))</span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="kw">print</span>(rdp_plot_pcr_all)</span></code></pre></div>
<p><img src="publication--02--rdp_files/figure-html/rdp_plot_pcr_all-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Since these are universal bacterial primers, we would expect most of the database to amplify. The plot shows this and very few sequences were not amplified. If we wanted to look at only those sequences that did not amplify, we could filter taxa by PCR success and plot what remains. I am including the supertaxa of those taxa that did not amplify since excluding them would split the tree into a cloud of fragments lacking taxonomic context.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>rdp_plot_pcr_fail &lt;-<span class="st"> </span>rdp_pcr <span class="op">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">filter_taxa</span>(prop_amplified <span class="op">&lt;</span><span class="st"> </span>pcr_success_cutoff, <span class="dt">supertaxa =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span><span class="kw">heat_tree</span>(<span class="dt">node_size =</span> query_count <span class="op">-</span><span class="st"> </span>seq_count,</span>
<span id="cb11-4"><a href="#cb11-4"></a>            <span class="dt">node_label =</span> taxon_names,</span>
<span id="cb11-5"><a href="#cb11-5"></a>            <span class="dt">node_color =</span> prop_amplified,</span>
<span id="cb11-6"><a href="#cb11-6"></a>            <span class="dt">node_size_range =</span> size_range <span class="op">*</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb11-7"><a href="#cb11-7"></a>            <span class="dt">edge_size_range =</span> size_range,</span>
<span id="cb11-8"><a href="#cb11-8"></a>            <span class="dt">node_size_interval =</span> pcr_size_interval,</span>
<span id="cb11-9"><a href="#cb11-9"></a>            <span class="dt">edge_size_interval =</span> pcr_size_interval,</span>
<span id="cb11-10"><a href="#cb11-10"></a>            <span class="dt">node_color_range =</span>  pcr_success_color_scale,</span>
<span id="cb11-11"><a href="#cb11-11"></a>            <span class="dt">node_color_trans =</span> <span class="st">&quot;linear&quot;</span>,</span>
<span id="cb11-12"><a href="#cb11-12"></a>            <span class="dt">node_color_interval =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb11-13"><a href="#cb11-13"></a>            <span class="dt">edge_color_interval =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb11-14"><a href="#cb11-14"></a>            <span class="dt">node_label_size_range =</span> label_size_range,</span>
<span id="cb11-15"><a href="#cb11-15"></a>            <span class="dt">node_label_max =</span> label_max,</span>
<span id="cb11-16"><a href="#cb11-16"></a>            <span class="dt">node_color_axis_label =</span> <span class="st">&quot;Proportion PCR success&quot;</span>,</span>
<span id="cb11-17"><a href="#cb11-17"></a>            <span class="dt">node_size_axis_label =</span> <span class="st">&quot;Sequences not amplified&quot;</span>,</span>
<span id="cb11-18"><a href="#cb11-18"></a>            <span class="dt">output_file =</span> <span class="kw">result_path</span>(<span class="st">&quot;rdp--pcr_fail&quot;</span>))</span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="kw">print</span>(rdp_plot_pcr_fail)</span></code></pre></div>
<p><img src="publication--02--rdp_files/figure-html/rdp_plot_pcr_fail-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="save-outputs-for-composite-figure" class="section level2">
<h2>Save outputs for composite figure</h2>
<p>Some results from this file will be combined with others from similar analyses to make a composite figure. Below, the needed objects are saved so that they can be loaded by another Rmd file.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">save</span>(<span class="dt">file =</span> <span class="kw">file.path</span>(output_folder,<span class="st">&quot;rdp_data.RData&quot;</span>),</span>
<span id="cb12-2"><a href="#cb12-2"></a>     rdp_plot_all, rdp_plot_pcr_fail)</span></code></pre></div>
</div>
<div id="software-and-packages-used" class="section level2">
<h2>Software and packages used</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre class="r-output"><code>## R version 4.0.3 (2020-10-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Pop!_OS 20.04 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       
##  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
## [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] metacoder_0.3.5      stringr_1.4.0        glossary_0.1.0       knitcitations_1.0.12
## [5] knitr_1.30          
## 
## loaded via a namespace (and not attached):
##  [1] progress_1.2.2    tidyselect_1.1.0  xfun_0.19         purrr_0.3.4       lattice_0.20-41  
##  [6] colorspace_1.4-1  vctrs_0.3.4       generics_0.1.0    htmltools_0.5.1.1 viridisLite_0.3.0
## [11] yaml_2.2.1        utf8_1.1.4        rlang_0.4.10      pillar_1.4.6      glue_1.4.2       
## [16] lifecycle_0.2.0   plyr_1.8.6        ggfittext_0.9.0   munsell_0.5.0     gtable_0.3.0     
## [21] codetools_0.2-16  evaluate_0.14     labeling_0.4.2    parallel_4.0.3    fansi_0.4.1      
## [26] Rcpp_1.0.5        readr_1.4.0       scales_1.1.1      jsonlite_1.7.1    farver_2.0.3     
## [31] gridExtra_2.3     ggplot2_3.3.2     hms_0.5.3         digest_0.6.27     stringi_1.5.3    
## [36] dplyr_1.0.2       ade4_1.7-16       grid_4.0.3        bibtex_0.4.2.3    cli_2.1.0        
## [41] tools_4.0.3       magrittr_2.0.1    lazyeval_0.2.2    tibble_3.0.4      RefManageR_1.2.12
## [46] crayon_1.3.4      ape_5.4-1         seqinr_4.2-4      pkgconfig_2.0.3   MASS_7.3-53      
## [51] ellipsis_0.3.1    prettyunits_1.1.1 xml2_1.3.2        lubridate_1.7.9   assertthat_0.2.1 
## [56] rmarkdown_2.5     httr_1.4.2        viridis_0.5.1     R6_2.5.0          igraph_1.2.6     
## [61] nlme_3.1-149      compiler_4.0.3
</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-maidak2001rdp">
<p>Maidak, Bonnie L, James R Cole, Timothy G Lilburn, Charles T Parker Jr, Paul R Saxman, Ryan J Farris, George M Garrity, Gary J Olsen, Thomas M Schmidt, and James M Tiedje. 2001. “The Rdp-Ii (Ribosomal Database Project).” <em>Nucleic Acids Research</em> 29 (1): 173–74.</p>
</div>
<div id="ref-walters2016improved">
<p>Walters, William, Embriette R Hyde, Donna Berg-Lyons, Gail Ackermann, Greg Humphrey, Alma Parada, Jack A Gilbert, et al. 2016. “Improved Bacterial 16S rRNA Gene (V4 and V4-5) and Fungal Internal Transcribed Spacer Marker Gene Primers for Microbial Community Surveys.” <em>mSystems</em> 1 (1): e00009–15.</p>
</div>
</div>
</div>

<div class="footer_section">
  <div class="footer_content">
    <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Metacoder's documentation</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://grunwaldlab.cgrb.oregonstate.edu/" property="cc:attributionName" rel="cc:attributionURL">The Grunwald lab and the USDA Horticultural Crops Research Unit</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/grunwaldlab/metacoder_documentation" rel="dct:source">https://github.com/grunwaldlab/metacoder_documentation</a>.
  </div>
</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
